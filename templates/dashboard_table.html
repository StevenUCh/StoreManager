<div class="bg-white dark:bg-gray-800 rounded-xl shadow p-4 mb-8 overflow-x-auto">

  <div class="flex justify-between items-center mb-3">
    <h5 class="text-lg font-semibold dark:text-gray-100">Movimientos recientes</h5>

    <div class="flex gap-2">
      <a href="{{ url_for('export_csv') }}"
         class="px-3 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm transition">
        Exportar CSV
      </a>

      <a href="{{ url_for('export_pdf') }}"
         class="px-3 py-1 bg-gray-700 hover:bg-gray-800 text-white rounded-lg text-sm transition">
        Exportar PDF
      </a>
    </div>
  </div>


  <!-- SPINNER AJAX -->
  <div id="spinner-ajax" class="flex justify-center my-4 hidden">
    <div class="w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"></div>
  </div>


  <!-- CONTENEDOR AJAX -->
  <div id="tabla-movimientos">

    <table class="w-full text-sm text-left text-gray-600 dark:text-gray-300">
      <thead class="bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200">
        <tr>
          <th class="px-3 py-2 text-center">Fecha</th>
          <th class="px-3 py-2 text-center">Tipo</th>
          <th class="px-3 py-2 text-center">Categoría</th>
          <th class="px-3 py-2 text-center">Descripción</th>
          <th class="px-3 py-2 text-center">Monto</th>
          <th class="px-3 py-2 text-center">Debe</th>
          <th class="px-3 py-2 text-center" colspan="2">Acciones</th>
        </tr>
      </thead>

      <tbody>
        {% for m in movimientos %}
        <tr class="border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition">

          <td class="text-center px-3 py-2">
            {{ m.fecha.strftime('%d/%m/%Y') if m.fecha.__class__.__name__ != 'str' else m.fecha }}
          </td>

          <td class="text-center px-3 py-2 capitalize">{{ m.tipo }}</td>
          <td class="text-center px-3 py-2">{{ m.categoria }}</td>
          <td class="text-center px-3 py-2">{{ m.descripcion }}</td>

          <td class="text-center px-3 py-2">
            {{ "{:,.0f}".format(m.monto) }}
          </td>

          <td class="text-center px-3 py-2">
            {{ "{:,.0f}".format(m.falta) }}
          </td>

          <td class="text-center px-3 py-2">
            <a href="{{ url_for('movimiento_detail', mov_id=m.id) }}"
               class="px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded text-xs">
              Ver
            </a>
          </td>

          <td class="text-center px-3 py-2">
            <form method="POST"
                  action="{{ url_for('movimiento_delete', mov_id=m.id) }}"
                  class="inline"
                  onsubmit="return confirm('¿Seguro que deseas eliminar este movimiento?');">

              <button type="submit"
                      class="px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-xs">
                Eliminar
              </button>
            </form>
          </td>

        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- PAGINACIÓN -->
    <div class="flex justify-center mt-4 relative">
        
        <!-- SPINNER PARA LA PAGINACIÓN -->
        <div id="spinner-pagination" class="hidden absolute gap-2">
          <div class="w-6 h-6 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"></div>
        </div>

        <nav id="paginacion-wrapper" class="flex gap-2">
          {% if pagination.has_prev %}
          <a href="{{ url_for('dashboard_table', page=pagination.prev_num) }}"
            class="ajax-page px-3 py-1 bg-gray-700 hover:bg-gray-800 text-white rounded-lg text-sm">
            Anterior
          </a>
          {% endif %}

          {% if pagination.has_next %}
          <a href="{{ url_for('dashboard_table', page=pagination.next_num) }}"
            class="ajax-page px-3 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm">
            Siguiente
          </a>
          {% endif %}
        </nav>

    </div>
  </div> 
</div>
